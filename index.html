<!DOCTYPE html>
<html lang="fa" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNS Cards</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="index.css">
    <link rel="icon" href="icon.png" type="image/png">
</head>

<body>
    <div id="app" class="container"></div>
    <div class="toast">کپی شد!</div>

    <script>
        const dnsLocations = [
            {
                id: 'germany',
                name: 'آلمان',
                countryCode: 'de',
                active: true,
                ipv4: ['185.149.213.148', '185.149.213.149'],
                ipv6: ['2a02:c6a0:74cd::1', '2a02:c6a0:74cd::0'],
                ipv6Enabled: true
            },
            {
                id: 'sweden',
                name: 'سوئد',
                countryCode: 'se',
                active: true,
                ipv4: ['185.57.168.87', '185.57.168.88'],
                ipv6: ['2001:678:d5c:bb26::1', '2001:678:d5c:bb26::0'],
                ipv6Enabled: true
                //  در صورتی ک نمیخای بزن false
            },
            {
                id: 'netherlands',
                name: 'هلند',
                countryCode: 'nl',
                active: true,
                ipv4: ['145.125.185.206', '145.125.185.207'],
                ipv6: ['2001:611:3b4d::1', '2001:611:3b4d::0'],
                ipv6Enabled: true
            },
            {
                id: 'iran',
                name: 'رادار',
                countryCode: 'ir',
                active: true,
                ipv4: ['10.202.10.10', '10.202.10.11'],
                ipv6: ['', ''],
                ipv6Enabled: false
            },
            {
                id: 'iran',
                name: 'الکترو',
                countryCode: 'ir',
                active: true,
                ipv4: ['78.157.42.100', '78.157.42.101'],
                ipv6: ['', ''],
                ipv6Enabled: false
            },
            {
                id: 'ukrain',
                name: 'اوکراین',
                countryCode: 'ua',
                active: false,
                ipv4: ['', ''],
                ipv6: ['', ''],
                ipv6Enabled: true
            },
            {
                id: 'poland',
                name: 'لهستان',
                countryCode: 'pl',
                active: true,
                ipv4: ['194.204.179.99', '80.54.157.76'],
                ipv6: ['2a01:1130:f094::1', '2a01:1130:f094::0'],
                ipv6Enabled: true
            },
            {
                id: 'usa',
                name: 'آمریکا',
                countryCode: 'us',
                active: false,
                ipv4: ['', ''],
                ipv6: ['', ''],
                ipv6Enabled: true
            },
                            id: 'canada',
                name: 'کانادا',
                countryCode: 'ca',
                active: true,
                ipv4: ['142.198.141.253', '72.184.8.174'],
                ipv6: ['2605:b100:116::1:3502:caa4', '2605:b100:116::1:3502:caa5'],
                ipv6Enabled: true
            }
        ];

        const wireguardConfig = {
            icon: '<img src="wire1.svg" alt="WireGuard">',
            servers: {
                WGserver1: "https://krakenfiles.com/view/xXnqxrrEpt/file.html",
                // WGserver2: "https://example.com/wireguard/usa.conf",
                // WGserver3: "https://example.com/wireguard/netherlands.conf"
            }
        };

        function getFlagUrl(countryCode) {
            // تغییر سایز از 48x36 به 96x72 برای کیفیت بهتر
            return `https://flagcdn.com/w320/${countryCode.toLowerCase()}.png`;
        }

        function createDNSCard(location) {
            const flagHtml = `
    <img 
        src="${getFlagUrl(location.countryCode)}"
        srcset="${getFlagUrl(location.countryCode)} 1x,
                https://flagcdn.com/w320/${location.countryCode}.png 2x"
        alt="${location.name} flag"
    >
`;

            return `
                <div class="card">
                    <div class="card-header">
                        <div class="location">
                            <div class="location-icon">${flagHtml}</div>
                            <span>${location.name}</span>
                        </div>
                        <div class="status ${location.active ? 'active' : 'inactive'}">
                            ${location.active ? 'فعال' : 'غیرفعال'}
                        </div>
                    </div>
                    <div class="dns-section">
                        <div class="section-title">DNS نسل ۴</div>
                        ${location.ipv4.map(ip => createDNSEntry(ip, true)).join('')}
                    </div>
                    <div class="dns-section">
                        <div class="section-title">DNS نسل ۶</div>
                        ${location.ipv6.map(ip => createDNSEntry(ip, location.ipv6Enabled)).join('')}
                    </div>
                </div>
            `;
        }

        function createDNSEntry(ip, enabled) {
            return `
                <div class="dns-entry ${!enabled ? 'disabled' : ''}" ${enabled ? `onclick="copyToClipboard('${ip}', this)"` : ''}>
                    <span>${ip}</span>
                    <button class="copy-button" ${!enabled ? 'disabled' : ''}>
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
            `;
        }

        function createWireGuardCard() {
            return `
                <div class="card wireguard-card">
                    <div class="card-header">
                        <div class="location">
                            <div class="location-icon">${wireguardConfig.icon}</div>
                            <span>کانفیگ وایرگارد</span>
                        </div>
                    </div>
                    <select id="serverSelect">
                        <option value="">انتخاب سرور</option>
                        ${Object.entries(wireguardConfig.servers).map(([server, url]) =>
                `<option value="${server}">${server}</option>`
            ).join('')}
                    </select>
                    <button class="download-btn" onclick="downloadConfig()">
                        <i class="fas fa-download"></i>
                        <span>دانلود کانفیگ</span>
                    </button>
                </div>
            `;
        }

        async function copyToClipboard(text, element) {
            if (element.classList.contains('disabled')) return;

            try {
                await navigator.clipboard.writeText(text);
                const button = element.querySelector('.copy-button i');
                button.classList.replace('fa-copy', 'fa-check');
                button.style.color = '#4CAF50';

                showToast();

                setTimeout(() => {
                    button.classList.replace('fa-check', 'fa-copy');
                    button.style.color = '';
                }, 2000);
            } catch (err) {
                console.error('Failed to copy:', err);
            }
        }

        function showToast() {
            const toast = document.querySelector('.toast');
            toast.style.display = 'block';
            setTimeout(() => {
                toast.style.display = 'none';
            }, 2000);
        }

        function downloadConfig() {
            const select = document.getElementById('serverSelect');
            const selectedServer = select.value;

            if (!selectedServer) {
                alert('لطفا یک سرور را انتخاب کنید');
                return;
            }

            const configUrl = wireguardConfig.servers[selectedServer];
            const link = document.createElement('a');
            link.href = configUrl;
            link.download = `wireguard-${selectedServer}.conf`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function renderApp() {
            const app = document.getElementById('app');
            const content = [...dnsLocations.map(createDNSCard),
            createWireGuardCard()
            ].join('');

            app.innerHTML = content;
        }

        document.addEventListener("contextmenu", (event) => event.preventDefault()); // غیرفعال کردن راست‌کلیک

        document.addEventListener("keydown", (event) => {
            if (event.key === "F12" || (event.ctrlKey && event.shiftKey && event.key === "I") ||
                (event.ctrlKey && event.shiftKey && event.key === "J") ||
                (event.ctrlKey && event.key === "U")) {
                event.preventDefault();
            }
        });

        (function blockDevTools() {
            const element = new Image();
            Object.defineProperty(element, 'id', {
                get: function () {
                    window.location.reload(); // ریلود صفحه هنگام باز کردن DevTools
                }
            });
            console.log('%c', element);
        })();

        // Initialize
        renderApp();
    </script>
</body>

</html>
